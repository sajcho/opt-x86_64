# Description:	Power Management Services
# URL:		https://upower.freedesktop.org
# Maintainer:	sajcho, saux dot aarch64 at gmail dot com
# Depends on:	libgudev

name=upower
version=1.90.0
release=0
source=(https://gitlab.freedesktop.org/${name}/${name}/-/archive/v${version}/${name}-v${version}.tar.bz2 \
	assume-battery-present.patch)

build() {
	cd ${name}-v${version}

	patch -p1 -i $SRC/assume-battery-present.patch

	build-meson \
		-Dman=false \
		-Dgtk-doc=false \
		-Dsystemdsystemunitdir=no \
		-Dudevhwdbdir=/etc/udev/hwdb.d \
		-Dudevrulesdir=/lib/udev/rules.d \
		. build

	meson compile ${JOBS:+-j ${JOBS}} -C build

	DESTDIR=$PKG meson install --no-rebuild -C build

	rm -r $PKG/usr/share/locale
}
