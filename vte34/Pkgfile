# Description:	Virtual Terminal Emulator library - GTK3, GTK4
# URL:		https://gitlab.gnome.org/GNOME/vte
# Maintainer:	sajcho, saux dot aarch64 at gmail dot com
# Depends on:	gtk3 gtk4 icu libpcre2 vala

name=vte34
_realname=vte
version=0.70.0
release=1
source=(https://gitlab.gnome.org/GNOME/${_realname}/-/archive/${version}/${_realname}-${version}.tar.gz \
	gtk4-clipboard-1.patch \
	gtk4-clipboard-2.patch)

build() {
	cd ${_realname}-${version}

	patch -p1 -i $SRC/gtk4-clipboard-1.patch
	patch -p1 -i $SRC/gtk4-clipboard-2.patch

	# Fix - we have include dir in /usr/include
	sed \
		-e 's|Werror=missing-include-dirs|Wno-deprecated-declarations|' \
		-e 's|Wmissing-include-dirs|Wno-missing-include-dirs|' \
		-i meson.build

	build-meson \
		-Dgtk4=true \
		-Ddocs=false \
		-D_systemd=false \
		. build

	meson compile ${JOBS:+-j ${JOBS}} -C build

	DESTDIR=$PKG meson install --no-rebuild -C build

	rm -r $PKG/usr/share/{glade,locale}
}
