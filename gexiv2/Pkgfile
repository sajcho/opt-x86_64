# Description:	GObject-based wrapper around the Exiv2 library
# URL:		https://wiki.gnome.org/Projects/gexiv2
# Maintainer:	sajcho, saux dot aarch64 at gmail dot com
# Depends on:	exiv2 gobject-introspection python3-gobject

name=gexiv2
version=0.14.1
release=2
source=(https://download.gnome.org/sources/${name}/${version%.*}/${name}-${version}.tar.xz \
	fix-compatibility-with-exiv2.patch)

build() {
	cd ${name}-${version}

	# Fix build with exiv2 0.28.0
	patch -p1 -i $SRC/fix-compatibility-with-exiv2.patch

	CFLAGS+=" -ffat-lto-objects"
	CXXFLAGS+=" -ffat-lto-objects"

	build-meson \
		-Dintrospection=true \
		-Dvapi=false \
		-Dgtk_doc=false \
		. build

	meson compile ${JOBS:+-j ${JOBS}} -v -C build

	DESTDIR=$PKG meson install --no-rebuild -C build
}
