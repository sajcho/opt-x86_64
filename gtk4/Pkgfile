# Description:	The GTK Toolkit (v4)
# URL:		https://www.gtk.org/
# Maintainer:	sajcho, saux dot aarch64 at gmail dot com
# Depends on:	adwaita-icon-theme at-spi2-core gdk-pixbuf graphene libxcursor libxinerama libxkbcommon vulkan-headers vulkan-loader wayland-protocols

name=gtk4
_realname=gtk
version=4.8.2
release=1
source=(https://download.gnome.org/sources/${_realname}/${version%.*}/${_realname}-${version}.tar.xz \
	copy-paste-touch-events-pr-5143.patch)

build() {
	cd ${_realname}-${version}

	patch -p1 -i $SRC/copy-paste-touch-events-pr-5143.patch

	build-meson \
		-Dvulkan=enabled \
		-Dcolord=disabled \
		-Dprint-cups=disabled \
		-Dbroadway-backend=true \
		-Dmedia-gstreamer=disabled \
		-Dbuild-examples=false \
		-Dbuild-tests=false \
		-Dman-pages=false \
		-Dgtk_doc=false \
		-Ddemos=false \
		-Dc_args="-fuse-ld=mold" \
		-Dc_link_args="-fuse-ld=mold" \
		. build

	meson compile ${JOBS:+-j ${JOBS}} -v -C build

	DESTDIR=$PKG meson install --no-rebuild -C build

	rm -r $PKG/usr/share/locale
}
